{
  "$schema": "../schemas/klogg-previews.schema.json",
  "version": 1,
  "previews": [
    {
      "name": "EHCP (direct quoted)",
      "enabled": true,
      "regex": "^.*\"(?<ehcp>EHCP[^\"]*)\".*$",
      "bufferCapture": "ehcp",
      "type": "string",
      "format": "fields",
      "fields": [
        {
          "name": "ehcp",
          "format": "match",
          "type": "string",
          "regex": "^(?<header>EHCP)(?<payload>[^!]*)!(?<checksum>[[:xdigit:]]{4})$",
          "bufferCapture": "payload",
          "fields": [
            {
              "name": "header",
              "source": "capture",
              "capture": "header",
              "format": "string"
            },
            {
              "name": "size",
              "width": 3,
              "type": "hexString",
              "format": "dig"
            },
            {
              "name": "data",
              "width": "{size}-5",
              "format": "string"
            },
            {
              "name": "checksum",
              "source": "capture",
              "capture": "checksum",
              "type": "hexString",
              "format": "hex"
            }
          ]
        }
      ]
    },

    {
      "name": "SRING -> EHCP",
      "enabled": true,
      "regex": "^SRING:\\s*\\d,\\d\\d,(?<hexPayload>[0-9A-Fa-f]+)$",
      "bufferCapture": "hexPayload",
      "type": "string",
      "format": "fields",
      "fields": [
        {
          "name": "ehcp",
          "format": "match",
          "type": "hexString",
          "regex": "^(?<header>EHCP)(?<payload>[^!]*)!(?<checksum>[[:xdigit:]]{4})$",
          "bufferCapture": "payload",
          "fields": [
            {
              "name": "header",
              "source": "capture",
              "capture": "header",
              "format": "string"
            },
            {
              "name": "size",
              "width": 3,
              "type": "hexString",
              "format": "dig"
            },
            {
              "name": "data",
              "width": "{size}-5",
              "format": "string"
            },
            {
              "name": "checksum",
              "source": "capture",
              "capture": "checksum",
              "type": "hexString",
              "format": "hex"
            }
          ]
        }
      ]
    }
  ]
}
